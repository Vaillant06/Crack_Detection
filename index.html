<!DOCTYPE html>
<html>

<head>
    <title>Crack Monitoring Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body {
            margin: 0;
            background: #0d0d0d;
            font-family: "Segoe UI", sans-serif;
            color: white;
        }

        .header {
            text-align: center;
            padding: 20px;
            font-size: 28px;
            font-weight: 600;
            background: #171717;
            box-shadow: 0 2px 10px #000;
            letter-spacing: 1px;
        }

        /* ---------- TOP STATS (4 CARDS) ---------- */
        .top-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px auto;
            width: 90%;
        }

        .stat-card {
            background: #1c1c1c;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            width: 22%;
            box-shadow: 0 2px 10px #000;
        }

        .stat-title {
            font-size: 18px;
            margin-bottom: 8px;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
        }

        .sev-severe {
            color: #ff3b3b;
        }

        .sev-moderate {
            color: #ffe600;
        }

        .sev-minor {
            color: #00ff8f;
        }

        .sev-none {
            color: #cccccc;
        }

        /* ---------- CENTER VIDEO SECTION ---------- */
        .video-section {
            width: 90%;
            margin: 20px auto;
        }

        .video-card {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 15px #000;
        }

        .video-frame {
            width: 100%;
            border-radius: 10px;
            border: 1px solid #333;
        }

        /* ---------- BOTTOM CURRENT INFO ---------- */
        .bottom-panel {
            width: 90%;
            margin: 20px auto 40px auto;
            background: #1c1c1c;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px #000;
        }

        .bottom-title {
            font-size: 22px;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .current-value {
            font-size: 32px;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="header">Real-Time Crack Monitoring Dashboard</div>

    <!-- TOP STATS -->
    <div class="top-stats">

        <div class="stat-card">
            <div class="stat-title">Total Cracks</div>
            <div id="t_total" class="stat-value sev-none">0</div>
        </div>

        <div class="stat-card">
            <div class="stat-title">Severe</div>
            <div id="t_severe" class="stat-value sev-severe">0</div>
        </div>

        <div class="stat-card">
            <div class="stat-title">Moderate</div>
            <div id="t_moderate" class="stat-value sev-moderate">0</div>
        </div>

        <div class="stat-card">
            <div class="stat-title">Minor</div>
            <div id="t_minor" class="stat-value sev-minor">0</div>
        </div>

    </div>


    <!-- CENTER VIDEO -->
    <div class="video-section">
        <div class="video-card">
            <h2>Live Feed</h2>
            <img class="video-frame" id="video" src="http://localhost:5000/video">
        </div>
    </div>


    <!-- BOTTOM CURRENT INFO -->
    <div class="bottom-panel">
        <div class="bottom-title">Current Frame Detection</div>

        <p>Cracks Detected:
            <span id="c_count" class="current-value sev-none">0</span>
        </p>

        <p>Severity:
            <span id="c_sev" class="current-value sev-none">None</span>
        </p>
    </div>



    <script>
        function updateInfo() {
            fetch("http://localhost:5000/info")
                .then(r => r.json())
                .then(data => {

                    // TOP TOTALS
                    document.getElementById("t_total").innerText = data.total_cracks;
                    document.getElementById("t_severe").innerText = data.total_severe;
                    document.getElementById("t_moderate").innerText = data.total_moderate;
                    document.getElementById("t_minor").innerText = data.total_minor;

                    // CURRENT FRAME
                    document.getElementById("c_count").innerText = data.current_count;
                    document.getElementById("c_sev").innerText = data.current_severity;

                    // Severity coloring for bottom section
                    const sev = data.current_severity;
                    const cc = document.getElementById("c_count");
                    const cs = document.getElementById("c_sev");

                    cc.className = "current-value";
                    cs.className = "current-value";

                    if (sev === "Severe") {
                        cc.classList.add("sev-severe");
                        cs.classList.add("sev-severe");
                    }
                    else if (sev === "Moderate") {
                        cc.classList.add("sev-moderate");
                        cs.classList.add("sev-moderate");
                    }
                    else if (sev === "Minor") {
                        cc.classList.add("sev-minor");
                        cs.classList.add("sev-minor");
                    }
                    else {
                        cc.classList.add("sev-none");
                        cs.classList.add("sev-none");
                    }
                });
        }

        setInterval(updateInfo, 800);
    </script>

</body>

</html>